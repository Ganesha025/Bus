<!DOCTYPE html>
<html lang="en">
<head>
    <title>ganesh – Find Your Bus</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-[#F3F4F6] min-h-screen flex flex-col">
<header id="mainHeader" class="fixed top-0 left-0 w-full z-50 bg-white/90 backdrop-blur-xl shadow transition-all duration-300">
    <div class="max-w-6xl mx-auto px-5 py-4 flex justify-between items-center">
        <div class="flex items-center">
            <img src="https://ganesa14.github.io/APM/insta%20logo-Photoroom.png" class="w-10 h-10 mr-3">
            <span class="text-2xl font-bold text-gray-800">Ganesh</span>
        </div>

        <nav class="hidden sm:flex space-x-6 font-semibold">
            <a href="search.html" class="text-gray-700 hover:text-indigo-600">Home</a>
            <a href="routelist.html" class="text-gray-700 hover:text-indigo-600">Routes</a>
            <a href="bus.html" class="text-gray-700 hover:text-indigo-600">Bus View</a>
        </nav>
    </div>
</header>

<div class="h-20"></div>
<main class="flex-1 flex justify-center px-4 py-8">
    <div class="w-full max-w-lg bg-white shadow-xl rounded-3xl p-8 border border-gray-200">

        <h1 class="text-3xl font-extrabold text-gray-800 text-center">Find Your Bus</h1>
        <p class="text-center text-gray-500 text-sm mb-6">Search and explore routes (including via locations)</p>

        <form class="space-y-6" onsubmit="event.preventDefault();searchRoutes();">
            <div class="flex flex-col gap-4">

                <div>
                    <label class="font-semibold text-gray-700">From District</label>
                    <input id="from" type="text" list="districts" autocomplete="off"
                        class="w-full mt-1 px-4 py-3 rounded-xl bg-gray-100 border border-gray-300 focus:bg-white focus:border-indigo-500 outline-none transition"
                        placeholder="Enter start location">
                </div>

                <div>
                    <label class="font-semibold text-gray-700">To District</label>
                    <input id="to" type="text" list="districts" autocomplete="off"
                        class="w-full mt-1 px-4 py-3 rounded-xl bg-gray-100 border border-gray-300 focus:bg-white focus:border-indigo-500 outline-none transition"
                        placeholder="Enter destination">
                </div>
            </div>

            <datalist id="districts"></datalist>

            <button
                class="w-full py-3 text-lg font-semibold text-white bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl shadow hover:scale-[1.02] active:scale-95 transition">
                Search Routes
            </button>
        </form>

        <div id="results" class="mt-8"></div>
    </div>
</main>

<footer class="w-full bg-white/90 backdrop-blur-xl border-t border-gray-200 shadow-xl">
    <div class="max-w-6xl mx-auto px-6 py-5 grid grid-cols-1 sm:grid-cols-3 gap-5 items-center">
        <div class="text-center sm:text-left">
            <div id="liveTime" class="text-sm font-bold text-indigo-700"></div>
            <div id="liveYear" class="text-xs text-gray-600 mt-1"></div>
        </div>
        <div class="flex flex-wrap justify-center text-sm font-semibold text-gray-700 gap-6">
            <a href="#" class="hover:text-indigo-600">About Us</a>
            <a href="#" class="hover:text-indigo-600">Routes</a>
            <a href="#" class="hover:text-indigo-600">Support</a>
            <a href="#" class="hover:text-indigo-600">Help</a>
        </div>
        <div class="flex justify-center sm:justify-end items-center gap-3">
            <span class="px-3 py-1 bg-gray-200 text-gray-700 rounded-lg text-xs">Download App</span>
            <img src="https://img.icons8.com/ios-filled/50/000000/google-play.png" class="w-6 opacity-70 hover:opacity-100">
            <img src="https://img.icons8.com/ios-filled/50/000000/mac-os.png" class="w-6 opacity-70 hover:opacity-100">
        </div>

    </div>
</footer>

<script>
function updateFooter() {
    const now = new Date();
    const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

    document.getElementById("liveTime").innerHTML =
        `${days[now.getDay()]}, ${now.toLocaleDateString()} — ${now.toLocaleTimeString()}`;

    document.getElementById("liveYear").innerHTML = `© ${now.getFullYear()} ganesh`;

    let count = localStorage.getItem("visitorCount");
    count = count ? Number(count) + 1 : 1;
    localStorage.setItem("visitorCount", count);

    document.getElementById("visitors").innerHTML = `Visitors Today: ${count}`;
}
setInterval(updateFooter, 1000);
updateFooter();
</script>
<script>
let routeData = [];
let allPlaces = new Set();
fetch("../data.json")
    .then(res => res.json())
    .then(data => {
        routeData = data.routes;

        routeData.forEach(route => {
            allPlaces.add(route.from);
            allPlaces.add(route.to);
            route.via?.forEach(v => allPlaces.add(v));
        });

        const list = document.getElementById("districts");
        [...allPlaces].sort().forEach(p => {
            const option = document.createElement("option");
            option.value = p;
            list.appendChild(option);
        });
    });

function searchRoutes() {
    const fromValue = document.getElementById("from").value.trim().toLowerCase();
    const toValue = document.getElementById("to").value.trim().toLowerCase();

    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    if (!fromValue || !toValue) {
        resultsDiv.innerHTML = `
        <div class="text-center bg-red-50 text-red-600 px-6 py-4 rounded-xl shadow font-semibold">
            Please fill both fields.
        </div>`;
        return;
    }

    const results = routeData.filter(route => {
        return (
            route.from.toLowerCase() === fromValue &&
            route.to.toLowerCase() === toValue
        );
    });

    if (results.length === 0) {
        resultsDiv.innerHTML = `
        <div class="text-center bg-orange-50 text-orange-700 px-6 py-4 rounded-xl shadow font-semibold">
            No routes found from <b>${fromValue}</b> to <b>${toValue}</b>.
        </div>`;
        return;
    }

    results.forEach(route => {
        resultsDiv.innerHTML += `
        <div class="bg-gradient-to-r from-indigo-50 to-purple-50 p-5 rounded-xl mb-4 border shadow">
            <div class="text-xl font-bold text-indigo-700">${route.from} → ${route.to}</div>
            
            ${route.via?.length
                ? `<div class="mt-2 text-sm text-gray-700">
                     <b>Via:</b> ${route.via.map(v => `<span class="bg-indigo-100 px-2 py-1 rounded text-indigo-800 mx-1">${v}</span>`).join("")}
                   </div>`
                : ""}

            <button onclick="goToRoute('${route.id}')"
                class="mt-4 w-full py-2 bg-indigo-600 text-white font-semibold rounded-lg shadow hover:bg-indigo-700 transition">
                View Buses
            </button>
        </div>`;
    });
}

function goToRoute(id) {
    localStorage.setItem("selectedRouteId", id);
    window.location.href = "routelist.html";
}
</script>

</body>
</html>
