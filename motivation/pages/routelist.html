<!DOCTYPE html>
<html lang="en">
<head>
    <title>Route Buses UI – Redbus Style</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col overflow-x-hidden">

<header class="sticky top-0 z-50 bg-white shadow-md">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <img src="https://ganesa14.github.io/APM/insta%20logo-Photoroom.png" class="w-12 h-12" />
            <h1 class="text-2xl font-extrabold text-gray-800 tracking-tight">Savage</h1>
        </div>
        <button onclick="goBack()" class="px-5 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-semibold shadow">
            Back
        </button>
    </div>
</header>

<section class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 py-10 shadow-lg">
    <div id="routeTitle" class="max-w-7xl mx-auto px-6 text-center text-white text-4xl font-extrabold"></div>
</section>

<div class="w-full bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-6 py-4 flex flex-wrap gap-3 justify-between items-center">
        <div class="flex flex-wrap gap-3 text-sm font-semibold text-gray-700">
            <button class="px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200">AC</button>
            <button class="px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200">Sleeper</button>
            <button class="px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200">Seater</button>
            <button class="px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200">Departure</button>
        </div>

        <select class="px-4 py-2 rounded-lg border-gray-300 bg-gray-50 text-sm font-semibold">
            <option>Sort: Recommended</option>
            <option>Early Departure</option>
            <option>Price: Low to High</option>
            <option>Price: High to Low</option>
        </select>
    </div>
</div>

<main class="flex-1 py-8 px-4">
    <div class="max-w-7xl mx-auto">
        <div id="buses" class="flex flex-col gap-6"></div>
    </div>
</main>

<footer class="bg-white shadow-inner py-8 mt-10 border-t border-gray-200">
    <div class="max-w-7xl mx-auto text-center text-gray-600 text-sm font-bold">
        © <span id="year"></span> Savage Info – All Rights Reserved
    </div>
</footer>

<script>
document.getElementById("year").textContent = new Date().getFullYear();

let routeData = [];

fetch("../data.json")
    .then(res => res.json())
    .then(data => {
        routeData = data.routes;
        loadBuses();
    });

function loadBuses() {
    const selectedRouteId = localStorage.getItem('selectedRouteId');
    if (!selectedRouteId) {
        document.getElementById('buses').innerHTML = noData();
        return;
    }

    const route = routeData.find(r => r.id === selectedRouteId);
    if (!route) {
        document.getElementById('buses').innerHTML = noData();
        return;
    }

    document.getElementById("routeTitle").innerHTML = `
        ${route.from} → ${route.to}
        <div class='text-white text-lg mt-2 opacity-90 font-medium'>
            ${route.via && route.via.length ? "Via: " + route.via.join(', ') : ""}
        </div>
    `;

    if (!route.buses || route.buses.length === 0) {
        document.getElementById('buses').innerHTML = noData();
        return;
    }

    document.getElementById('buses').innerHTML = route.buses.map(bus => busCard(bus)).join('');
}

function busCard(bus) {
    return `
    <div onclick="goToBus('${bus.id}')"
        class="bg-white border border-gray-200 rounded-2xl shadow hover:shadow-xl transition-all hover:-translate-y-1 p-6 cursor-pointer">
        
        <div class="flex flex-col md:flex-row justify-between gap-6">

            <div class="flex-1">
                <div class="flex items-center gap-3">
                    <h3 class="text-xl font-bold text-gray-900">${bus.operator}</h3>
                    <span class="px-3 py-1 text-xs bg-indigo-100 text-indigo-700 rounded-full font-semibold">
                        ${bus.bus_type}
                    </span>
                </div>

                <div class="flex items-center gap-2 mt-2 text-yellow-500 text-sm font-semibold">
                    ⭐ 4.${Math.floor(Math.random() * 5) + 1}
                    <span class="text-gray-500">(980 ratings)</span>
                </div>

                <div class="flex items-center mt-6 text-gray-700 font-semibold text-lg">
                    <span>${bus.departure}</span>
                    <div class="mx-4 flex-1 h-0.5 bg-gray-300 relative">
                        <div class="absolute left-0 top-1/2 -translate-y-1/2 w-2 h-2 bg-indigo-600 rounded-full"></div>
                        <div class="absolute right-0 top-1/2 -translate-y-1/2 w-2 h-2 bg-purple-600 rounded-full"></div>
                    </div>
                    <span>${bus.arrival}</span>
                </div>

                <div class="text-sm text-gray-500 mt-1">
                    Duration: ${bus.duration || "—"}
                </div>
            </div>

            <div class="w-full md:w-40 flex flex-col justify-end text-right">
                <div class="text-xl font-bold text-gray-900 mb-2">
                    ₹${bus.price || "—"}
                </div>

                <div class="text-sm text-green-600 font-semibold mb-3">
                    ${bus.seats_left || Math.floor(Math.random() * 20) + 5} seats left
                </div>

                <button class="py-3 w-full md:w-auto px-6 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl font-semibold shadow">
                    View Seats
                </button>
            </div>

        </div>
    </div>`;
}

function noData() {
    return `<div class='text-center text-gray-700 font-semibold text-lg py-16'>No buses available.</div>`;
}

function goToBus(busId) {
    localStorage.setItem('selectedBusId', busId);
    window.location.href = 'bus.html';
}

function goBack() {
    window.location.href = 'search.html';
}
</script>

</body>
</html>
